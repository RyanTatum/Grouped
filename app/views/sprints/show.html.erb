<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <style>
      body {
        min-width: 520px;
      }
      .column {
        width: 175px;
        display: inline-block;
        vertical-align: top;
        position: relative;
        padding-bottom: 100px;
      }
      .portlet {
        margin: 0 1em 1em 0;
        padding: 0.3em;
      }
      .portlet-header {
        padding: 0.2em 0.3em;
        margin-bottom: 0.5em;
        position: relative;
      }
      .portlet-toggle {
        position: absolute;
        top: 50%;
        right: 0;
        margin-top: -8px;
      }
      .portlet-content {
        padding: 0.4em;
      }
      .portlet-placeholder {
        border: 1px dotted black;
        margin: 0 1em 1em 0;
        height: 50px;
      }
      
      .title {
          color: white;
      }
      .sprint_container {
          margin-left: 14%;
          margin-right: 14%;
          display: inline-block;
          width: 72%;
          background-color: #ffa366;
      }
      .tilt.right {
        transform: rotate(3deg);
        -moz-transform: rotate(3deg);
        -webkit-transform: rotate(3deg);
      }
      tilt.left {
        transform: rotate(-3deg);
        -moz-transform: rotate(-3deg);
        -webkit-transform: rotate(-3deg);
      }
      .menu {
          background-color:white;
          width: 15%;
          height: 100px%;
          margin: 0 1em 1em 0;
          padding: 0.3em;
          float: left;
      }
      
      .menu li {
          margin: 0 1em 1em 0;
      }
    </style>
      
    <script type="text/javascript">
      $(document).ready(function() {
      });
        
        function changeTable() {
          document.getElementById("todo").innerHTML = "<h2 class='title'>ToDo</h2>";
          document.getElementById("doing").innerHTML = "<h2 class='title'>Doing</h2>";
          document.getElementById("done").innerHTML = "<h2 class='title'>Done</h2>";

          Parse.initialize("Y25GZkeg7cc6dGRDBkhw8SgxmOwT3orM7O6SxSlD","lidAaWkyQwVQRgeMwKB3PCPt09Mzfwe0T02KK0Mg");
          var Feature = Parse.Object.extend("Feature");
          var query = new Parse.Query(Feature);
          var text = "";
          query.equalTo("sprint_id", $( "#sprint_field" ).val());
          query.find({
            success:function(features) {
                for (i = 0; i < features.length; i++) { 
                    var object = features[i];
                    var div = document.createElement('div');
                    div.setAttribute('class', 'portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all');
                    document.body.appendChild(div);
                    text = "<div class='portlet-header ui-sortable-handle ui-widget-header ui-corner-all'>" + "<span class='ui-icon ui-icon-minusthick portlet-toggle'></span>" + object.get('name') + "</div>" + "<div class='portlet-content'>" + object.get('description') + "</div>";
                    div.innerHTML = text;
                    var columnName = object.get("Status")
                    
                    if (columnName == "todo") {
                      document.getElementById("todo").appendChild(div);
                    }
                    else if (columnName == "doing") {
                      document.getElementById("doing").appendChild(div);
                    }
                    else if (columnName == "done") {
                      document.getElementById("done").appendChild(div);
                    }
                }
            }
          });
        }
        
        // Monitor tilt direction and switch between classes accordingly
        function tilt_direction(item) {
          var left_pos = item.position().left,
            move_handler = function (e) {
              if (e.pageX >= left_pos) {
                item.addClass("right");
                item.removeClass("left");
              } else {
                item.addClass("left");
                item.removeClass("right");
              }
              left_pos = e.pageX;
            };
            
            $("html").bind("mousemove", move_handler);
            item.data("move_handler", move_handler);
        }
        
          $(function() {
            $( ".column" ).sortable({
              connectWith: ".column",
              handle: ".portlet-header",
              cancel: ".portlet-toggle .title",
              placeholder: "portlet-placeholder ui-corner-all",
              start: function (event, ui) {
                    ui.item.addClass('tilt');
                    // Start monitoring tilt direction
                    tilt_direction(ui.item);
              },
              stop: function (event, ui) {
                    ui.item.removeClass("tilt");
                    // Unbind temporary handlers and excess data
                    $("html").unbind('mousemove', ui.item.data("move_handler"));
                    ui.item.removeData("move_handler");
              }
            });
            $( ".portlet" )
              .addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
              .find( ".portlet-header" )
                .addClass( "ui-widget-header ui-corner-all" )
                .prepend( "<span class='ui-icon ui-icon-minusthick portlet-toggle'></span>");
         
            $( ".portlet-toggle" ).click(function() {
              var icon = $( this );
              icon.toggleClass( "ui-icon-minusthick ui-icon-plusthick" );
              icon.closest( ".portlet" ).find( ".portlet-content" ).toggle();
            });
          });
    </script>
  <head>
    <script type="text/javascript" async="" src="//www.googleadservices.com/pagead/conversion_async.js"></script><script type="text/javascript" async="" src="//munchkin.marketo.net/151/munchkin.js"></script><script type="text/javascript" async="" src="//munchkin.marketo.net/151/munchkin.js"></script><script async="" src="//connect.facebook.net/en_US/fbds.js"></script><script async="" src="//www.googletagmanager.com/gtm.js?id=GTM-56BZ4D"></script><script type="text/javascript" async="" src="https://tag.perfectaudience.com/serve/52373e831aa4c02794000069.js"></script><script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script>
    <title>Home | Parse</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:600italic,400,600,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:100" rel="stylesheet" type="text/css">
    <%= stylesheet_link_tag "application", media: "all", "data-turbolinks-track" => true %>
    <%= javascript_include_tag "application", "data-turbolinks-track" => true %>

        <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
        <meta name="apple-mobile-web-app-title" content="Parse">
        <link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192">
        <link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
        <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
        <meta name="msapplication-TileColor" content="#5298fc">
        <meta name="msapplication-TileImage" content="/mstile-144x144.png">
        <meta name="application-name" content="Parse">

    <!--
    <link href="/assets/main.css?ef16d0b" media="screen" rel="stylesheet" type="text/css">
    <link href="/assets/print.css?ef16d0b" media="print" rel="stylesheet" type="text/css">
    >
    <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="/stylesheets/ie7.css" />
    <![endif]-->
    <!--[if IE 8]>
        <link rel="stylesheet" type="text/css" href="/stylesheets/ie8.css" />
    <![endif]-->
    <!--[if lt IE 10]>
        <link rel="stylesheet" type="text/css" href="/stylesheets/ie89.css" />
    <![endif]-->
    <script>if(Function('/*@cc_on return document.documentMode===10@*/')()){document.documentElement.className+=' ie10';}</script>

    <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="uYGOKj06BBOqKKGdqZEXaFHgNN/1qJG/w+WJwP803q8=">
    <meta name="description" content="Focus on creating unique &amp; engaging apps on any platform. We take care of everything else your app needs, from the core of your app to analytics and push notifications.">
    <meta name="keywords" content="backend, mobile, development, server, code">
    <meta property="fb:app_id" content="361736430535656">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Parse">
    <meta property="og:image" content="http://parse.com/images/og/default.jpg">
    <meta property="og:description" content="Focus on creating unique &amp; engaging apps on any platform. We take care of everything else your app needs, from the core of your app to analytics and push notifications.">
    <meta property="og:url" content="https://parse.com/apps">
    <meta name="viewport" content="width=device-width, initial-scale=1"><script src="//www.parsecdn.com/js/parse-1.6.14.min.js"></script>
    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
    <script src="//www.parsecdn.com/js/parse-1.6.14.min.js"></script>
    <script type="text/javascript" async="" src="https://pixel-geo.prfct.co/tagjs?a_id=16580&amp;source=js_tag"></script></head>
</head>
<% if session[:current_user]["profile_picture"]["url"]
    profile_picture = session[:current_user]["profile_picture"]["url"]
  else
    profile_picture = "profile_picture.png"
  end
%>

<body onload="changeTable()">
<div class="sprint_container" id="view">
    <% sprints_array = @sprints.map { |sprint| [sprint["name"], sprint["objectId"]] } %>
    <a class = 'title' href="https://icon.uiowa.edu" style="text-decoration: none"><h2>Sprint Board</h2></a>
    <div class = "menu">
    <ul>
      <li>Add A Feature</li>
      <li>New Sprint</li> 
      <li><%= select_tag(:sprint_id, options_for_select(sprints_array), :onchange => 'changeTable()', :id => "sprint_field", :class => "form-control") %></li>
    </ul>
        
        
    </div>
  <div class= "center_wrapper">
      <div class="column" id="todo"></div>
      <div class="column" id="doing"></div>
      <div class="column" id="done"></div>
  </div>
</div>
</body>
</html>